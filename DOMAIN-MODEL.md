# Java Bank Challenge Design

## User Stories

```
- As a customer, So I can safely store use my money, I want to create a current account.
- As a customer, So I can save for a rainy day, I want to create a savings account.
- As a customer, So I can keep a record of my finances, I want to generate bank statements
     with transaction dates, amounts, and balance at the time of transaction.
- As a customer, So I can use my account, I want to deposit and withdraw funds.

- As an engineer, So I don't need to keep track of state, I want account balances 
     to be calculated based on transaction history instead of stored in memory.
- As a bank manager, So I can expand, I want accounts to be associated with specific branches.
- As a customer, So I have an emergency fund, I want to be able to request an overdraft on my account.
- As a bank manager, So I can safeguard our funds, I want to approve or reject overdraft requests.
- As a customer, So I can stay up to date, I want statements to be sent as messages to my phone.
```

## Domain Model

| Class                            | Property                                         | Method                                                                                             | Scenario                                                              | Outcome                                                                                                |
|----------------------------------|--------------------------------------------------|----------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------|
| `Main`                           |                                                  |                                                                                                    |                                                                       |                                                                                                        |
|                                  |                                                  | `main(args: String[]): void`                                                                       |                                                                       |                                                                                                        |
|                                  |                                                  | `createSampleData(): void` <!--Keep in Main? Do I even need it?-->                                 |                                                                       |                                                                                                        |
| `Bank`                           |                                                  |                                                                                                    |                                                                       |                                                                                                        |
|                                  | `bankName: String`                               |                                                                                                    |                                                                       |                                                                                                        |
|                                  | `bankCode: String`                               |                                                                                                    |                                                                       |                                                                                                        |
|                                  | `locale: Locale`                                 |                                                                                                    |                                                                       |                                                                                                        |
|                                  | `bankManager: BankManager`                       |                                                                                                    |                                                                       |                                                                                                        |
|                                  | `branches: List<Branch>`                         |                                                                                                    |                                                                       |                                                                                                        |
|                                  |                                                  | `addBranch(branch: Branch): void`                                                                  | To create a new Branch for the Bank.                                  | Creates a new Branch and adds it to the branches list.                                                 |
|                                  |                                                  |                                                                                                    | Branch already exists.                                                | Show corresponding message.                                                                            |
|                                  |                                                  | `removeBranch(branch: Branch): void`                                                               | To remove a Branch from the Bank.                                     | Removes a Branch from the branches list.                                                               |
|                                  |                                                  |                                                                                                    | Branch doesn't exist.                                                 | Show corresponding message.                                                                            |
| `Branch`                         |                                                  |                                                                                                    |                                                                       |                                                                                                        |
|                                  | `branchName: String`                             |                                                                                                    |                                                                       |                                                                                                        |
|                                  | `branchCode: String`                             |                                                                                                    |                                                                       |                                                                                                        |
|                                  | `bank: Bank`                                     |                                                                                                    |                                                                       |                                                                                                        |
|                                  | `customers: List<Customer>`                      |                                                                                                    |                                                                       |                                                                                                        |
|                                  |                                                  | `addCustomer(customer: Customer): void`                                                            | To create a new Customer.                                             | Creates a new Customer and adds it to the customers list.                                              |
|                                  |                                                  |                                                                                                    | Customer already exists.                                              | Show corresponding message.                                                                            |
|                                  |                                                  | `removeCustomer(customer: Customer): void`                                                         | To remove a Customer.                                                 | Removes a Customer from the customers list.                                                            |
|                                  |                                                  |                                                                                                    | Customer doesn't exist.                                               | Show corresponding message.                                                                            |
| `IDCard` <!--TODO Nested?-->     |                                                  |                                                                                                    |                                                                       |                                                                                                        |
|                                  | `cardCode: String`                               |                                                                                                    |                                                                       |                                                                                                        |
|                                  | `givenNames: String`                             |                                                                                                    |                                                                       |                                                                                                        |
|                                  | `surname: String`                                |                                                                                                    |                                                                       |                                                                                                        |
|                                  | `dateOfBirth: LocalDate`                         |                                                                                                    |                                                                       |                                                                                                        |
| `Customer`                       |                                                  |                                                                                                    |                                                                       |                                                                                                        |
|                                  | `tin: String`                                    |                                                                                                    |                                                                       |                                                                                                        |
|                                  | `customerIDCard: CustomerIDCard`                 |                                                                                                    |                                                                       |                                                                                                        |
|                                  | `branch: Branch`                                 |                                                                                                    |                                                                       |                                                                                                        |
|                                  | `accounts: List<Account>`                        |                                                                                                    |                                                                       |                                                                                                        |
|                                  |                                                  | `addAccount(accountType: AccountType): void`                                                       | To create a new Account of the specified type.                        | Creates a new Account of the specified type and adds it to the accounts list.                          |
|                                  |                                                  |                                                                                                    | Account already exists.                                               | Show corresponding message.                                                                            |
|                                  |                                                  | `addAccount(accountType: AccountType, amount: BigDecimal): void`                                   | To create a new Account of the specified type with an initial amount. | Creates a new Account of the specified type, with an initial amount, and adds it to the accounts list. |
| `Money`                          |                                                  |                                                                                                    | Account already exists.                                               | Show corresponding message.                                                                            |
|                                  | `amount: BigDecimal`                             |                                                                                                    |                                                                       |                                                                                                        |
|                                  | `currency: Currency`                             |                                                                                                    |                                                                       |                                                                                                        |
|                                  | `numberFormat: NumberFormat` <!--TODO:remove?--> |                                                                                                    |                                                                       |                                                                                                        |
| `Transaction`                    |                                                  |                                                                                                    |                                                                       |                                                                                                        |
|                                  | `transactionID: String`                          |                                                                                                    |                                                                       |                                                                                                        |
|                                  | `date: LocalDate`                                |                                                                                                    |                                                                       |                                                                                                        |
|                                  | `type: TransactionType`                          |                                                                                                    |                                                                       |                                                                                                        |
|                                  | `amount: Money`                                  |                                                                                                    |                                                                       |                                                                                                        | 
|                                  | `account: Account`                               |                                                                                                    |                                                                       |                                                                                                        |
| `Account: abstract`              |                                                  |                                                                                                    |                                                                       |                                                                                                        |
|                                  | `iban: String`                                   |                                                                                                    |                                                                       |                                                                                                        |
|                                  | `accountNumber: String`                          |                                                                                                    |                                                                       |                                                                                                        |
|                                  | `customer: Customer`                             |                                                                                                    |                                                                       |                                                                                                        |
|                                  | `transactions: List<Transaction>`                |                                                                                                    |                                                                       |                                                                                                        |
|                                  |                                                  | `-generateAccountNumber(): void`                                                                   | Create a new Account.                                                 | Generates a unique account number.                                                                     |
|                                  |                                                  | `-composeIBAN(): void`                                                                             | Create a new Account.                                                 | Composes IBAN from Bank's locale and code, Branch's code and account number.                           |
|                                  |                                                  | `printBankStatement(): void`                                                                       | To view the transaction history for this account.                     | Prints all transactions that have been made in this account.                                           |
|                                  |                                                  |                                                                                                    | No transactions have been made.                                       | Show corresponding message.                                                                            |
|                                  |                                                  | `deposit(amount: BigDecimal): void`                                                                | To deposit an amount of money in this account.                        | Creates a new Transaction of DEPOSIT type and adds it to the transactions list.                        |
|                                  |                                                  | `withdraw(amount: BigDecimal): void`                                                               | To withdraw an amount of money from this accounts.                    | Creates a new Transaction of WITHDRAWAL type and adds it to the transactions list.                     |
|                                  |                                                  |                                                                                                    | Not enough money in the account.                                      | Show corresponding message.                                                                            |
|                                  |                                                  | `getBalance() : Money`                                                                             | To get the balance of this account.                                   | Return the amount of money in this account.                                                            |
| `CurrentAccount extends Account` |                                                  |                                                                                                    |                                                                       |                                                                                                        |
|                                  | `overdraftRequests: List<OverdraftRequest>`      |                                                                                                    |                                                                       |                                                                                                        |
|                                  |                                                  | `requestOverdraft(amount: BigDecimal): void`                                                       | Request an overdraft from this account.                               | Creates a new OverdraftRequest which is in PENDING state and awaits approval.                          |
|                                  |                                                  | `overdraft(overdraftRequest: OverdraftRequest): void`                                              | Withdraw the amount requested.                                        | Creates a new Transaction of WITHDRAWAL type and adds it to the transactions list.                     |
|                                  |                                                  |                                                                                                    | Overdraft hasn't been approved. Overdraft hasn't been processed.      | Show corresponding message.                                                                            |
| `SavingsAccount extends Account` |                                                  |                                                                                                    |                                                                       |                                                                                                        |
| `OverdraftRequest`               |                                                  |                                                                                                    |                                                                       |                                                                                                        |
|                                  | `account: Account`                               |                                                                                                    |                                                                       |                                                                                                        |
|                                  | `state: OverdraftState`                          |                                                                                                    |                                                                       |                                                                                                        |
|                                  | `amount: Money`                                  |                                                                                                    |                                                                       |                                                                                                        |
| `BankManager`                    |                                                  |                                                                                                    |                                                                       |                                                                                                        |
|                                  |                                                  | `processOverdraftRequest(overdraftRequest: OverdraftRequest, state: OverdraftState): void`         |                                                                       | Set the state of the overdraft request to one of the available options.                                |
| `Controller`                     |                                                  |                                                                                                    | A Controller class to create and manage Objects and check Inputs      |                                                                                                        |
|                                  | `banks: List<Bank>`                              |                                                                                                    |                                                                       |                                                                                                        |
|                                  |                                                  | `createBankManager(): BankManager`                                                                 |                                                                       |                                                                                                        |
|                                  |                                                  | `createBank(bankName: String, bankCode: String, locale: Locale, bankManager: BankManager): Bank`   |                                                                       |                                                                                                        |
|                                  |                                                  | `createBranch(bank: Bank, branchName: String, bankCode: String): Branch`                           |                                                                       |                                                                                                        |
|                                  |                                                  | `createIDCard(cardCode: String, givenNames: String, surname: String, dateOfBirth: String): IDCard` |                                                                       |                                                                                                        |
|                                  |                                                  | `createCustomer(branch: Branch, idCard: IDCard, tin: String): Customer`                            |                                                                       |                                                                                                        |
|                                  |                                                  | `createAccount(Customer customer, accountType: AccountType): Account`                              |                                                                       |                                                                                                        |
|                                  |                                                  | `createAccount(Customer customer, accountType: AccountType, amount: BigDecimal): Account`          |                                                                       |                                                                                                        |
|                                  |                                                  | `createOverdraftRequest(account: Account, amount: BigDecimal): OverdraftRequest`                   |                                                                       |                                                                                                        |

### Enumerations Used

```
TransactionType: WITHDRAWAL, DEPOSIT
AccountType: CURRENT, SAVINGS
OverdraftState: PENDING, APPROVED, DENIED
``` 

### Mapping - Classes in Package, Enums in Class

| Package            | Class              | Enum              |
|--------------------|--------------------|-------------------|
| `core`             | `Main`             |                   |
|                    | `Controller`       |                   |
| `core.bank`        |                    |                   |
|                    | `Bank`             |                   |
|                    | `BankManager`      |                   |
|                    | `Branch`           |                   |
| `core.customer`    |                    |                   |
|                    | `IDCard`           |                   |
|                    | `Customer`         |                   |
| `core.account`     |                    |                   |
|                    | `Account`          |                   |
|                    |                    | `AccountType`     |
|                    | `CurrentAccount`   |                   |
|                    | `SavingsAccount`   |                   |
| `core.transaction` |                    |                   |
|                    | `Transaction`      |                   |
|                    |                    | `TransactionType` |
|                    | `OverdraftRequest` |                   |
|                    |                    | `OverdraftState`  |
|                    | `Money`            |                   |

### Extra details

```
IBAN (International Bank Account Number) structure: Country Code(2) + Check Digits(2) + BBAN(23).
BBAN (Basic Bank Account Number) structure: Bank Code(3) Branch Code(4) Account Number(16).
TIN (Tax Identification Number) structure: Country Code(2) + A nine digit number.
Prints in Outcome means: print to the console. TODO?
Private methods have a "-" sign.
assume a Greek Locale. TODO?
toString, Comparable, equals, hashcode are not mentioned in the domain model. TODO?
The getters for the Enumeration are not mentioned in the domain model. TODO?
Unique Values: bankCode, branchCode, accountNumber, IBAN, IDCard.cardCode, TIN.
Outcomes addition: all outcomes inform the user in some way. TODO?
A Bank must have one BankManager, and can have only one.
```

<!-- 
TODO:
 - Create UML Diagram
 - Update domain with static methods. update details: represented by _method
 - Controller.-checkDateFormat(date: String)
 - BankManager/Customer could extend User
 - Locale Greece = el_GR ?
 - UserInterface/MessageClass/Controller.print() - replace/use printBankStatement and change getBalance().
 - Check for wrong inputs?
 - For Bank - Branch - Customer - Override and modify equals method to check so specific fields must be unique.
 - Search todo
 - To implement messaging Twilio or alternative
-->

## Class Diagram

![A class diagram.](/assets/uml_diagram.png)