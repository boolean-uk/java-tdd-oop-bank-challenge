# Java Bank Challenge Design

## User Stories

```
- As a customer, So I can safely store use my money, I want to create a current account.
- As a customer, So I can save for a rainy day, I want to create a savings account.
- As a customer, So I can keep a record of my finances, I want to generate bank statements
     with transaction dates, amounts, and balance at the time of transaction.
- As a customer, So I can use my account, I want to deposit and withdraw funds.

- As an engineer, So I don't need to keep track of state, I want account balances 
     to be calculated based on transaction history instead of stored in memory.
- As a bank manager, So I can expand, I want accounts to be associated with specific branches.
- As a customer, So I have an emergency fund, I want to be able to request an overdraft on my account.
- As a bank manager, So I can safeguard our funds, I want to approve or reject overdraft requests.
- As a customer, So I can stay up to date, I want statements to be sent as messages to my phone.
```

## Domain Model

| Class                            | Property                                    | Method                                                                                      | Scenario                                                                                                      | Outcome                                                                                                |
|----------------------------------|---------------------------------------------|---------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------|
| `Main`                           |                                             |                                                                                             |                                                                                                               |                                                                                                        |
|                                  |                                             | `main(args: String[]): void`                                                                |                                                                                                               |                                                                                                        |
|                                  |                                             | `generateSampleData(): void`                                                                | Showcase print bank statement.                                                                                |                                                                                                        |
| `Bank`                           |                                             |                                                                                             |                                                                                                               |                                                                                                        |
|                                  | `bankName: String`                          |                                                                                             |                                                                                                               |                                                                                                        |
|                                  | `bankCode: String`                          |                                                                                             |                                                                                                               |                                                                                                        |
|                                  | `locale: Locale`                            |                                                                                             |                                                                                                               |                                                                                                        |
|                                  | `bankManager: BankManager`                  |                                                                                             |                                                                                                               |                                                                                                        |
|                                  | `branches: List<Branch>`                    |                                                                                             |                                                                                                               |                                                                                                        |
|                                  |                                             | `isThreeDigitNumber(strNum: String): boolean`                                               | To validate the bank code upon creation. Bank code is a three digit positive number.                          | Return true. Continues the creation of the new Bank.                                                   |
|                                  |                                             |                                                                                             | Bank code is not a three digit positive number.                                                               | Return false. Throws an Illegal Argument Exception.                                                    |
|                                  |                                             | `createBranch(branchName: String, branchCode: String): void`                                | To create a new Branch for the Bank.                                                                          | Creates a new Branch and adds it to the branches list.                                                 |
|                                  |                                             |                                                                                             | Branch with same name or code already in branches list.                                                       | Show corresponding message.                                                                            |
|                                  |                                             | `createBankManager(): void`                                                                 | To add a bank manager to the Bank.                                                                            | Creates and adds a bank manager to the bank if on doesn't already exist.                               |
|                                  |                                             |                                                                                             | Bank already has a manager.                                                                                   | Show corresponding message.                                                                            |
| `Branch`                         |                                             |                                                                                             |                                                                                                               |                                                                                                        |
|                                  | `branchName: String`                        |                                                                                             |                                                                                                               |                                                                                                        |
|                                  | `branchCode: String`                        |                                                                                             |                                                                                                               |                                                                                                        |
|                                  | `bank: Bank`                                |                                                                                             |                                                                                                               |                                                                                                        |
|                                  | `customers: List<Customer>`                 |                                                                                             |                                                                                                               |                                                                                                        |
|                                  |                                             | `isFourDigitNumber(strNum: String): boolean`                                                | To validate the branch code upon creation. Branch code is a four digit positive number.                       | Return true. Continues the creation of the new Branch.                                                 |
|                                  |                                             |                                                                                             | Branch code is not a four digit positive number.                                                              | Return false. Throws an Illegal Argument Exception.                                                    |
|                                  |                                             | `createCustomer(customer: Customer): void`                                                  | To create a new Customer.                                                                                     | Creates a new Customer and adds it to the customers list.                                              |
|                                  |                                             | `isAccountNumberUnique(accountNumber: String): boolean`                                     | Part of creating a new Account. An account with the same account number doesn't exists under the same branch. | Return true. Continues the creation of the new Account.                                                |
|                                  |                                             |                                                                                             | An account with the same account number exists under the same branch.                                         | Return false. Generates another account number.                                                        |
|                                  |                                             |                                                                                             | Customer already exists.                                                                                      | Show corresponding message.                                                                            |
| `Customer`                       |                                             |                                                                                             |                                                                                                               |                                                                                                        |
|                                  | `tin: String`                               |                                                                                             |                                                                                                               |                                                                                                        |
|                                  | `idCard: IDCard`                            |                                                                                             |                                                                                                               |                                                                                                        |
|                                  | `branch: Branch`                            |                                                                                             |                                                                                                               |                                                                                                        |
|                                  | `accounts: List<Account>`                   |                                                                                             |                                                                                                               |                                                                                                        |
|                                  |                                             | `createAccount(accountType: ACCOUNT_TYPE): void`                                            | To create a new Account of the specified type.                                                                | Creates a new Account of the specified type and adds it to the accounts list.                          |
|                                  |                                             |                                                                                             | Account already exists.                                                                                       | Show corresponding message.                                                                            |
|                                  |                                             | `createAccount(accountType: ACCOUNT_TYPE, amount: BigDecimal): void`                        | To create a new Account of the specified type with an initial amount.                                         | Creates a new Account of the specified type, with an initial amount, and adds it to the accounts list. |
| `Money`                          |                                             |                                                                                             | Account already exists.                                                                                       | Show corresponding message.                                                                            |
|                                  | `amount: BigDecimal`                        |                                                                                             |                                                                                                               |                                                                                                        |
|                                  | `numberFormat: NumberFormat`                |                                                                                             |                                                                                                               |                                                                                                        |
| `Transaction`                    |                                             |                                                                                             |                                                                                                               |                                                                                                        |
|                                  | `transactionID: String`                     |                                                                                             |                                                                                                               |                                                                                                        |
|                                  | `date: LocalDate`                           |                                                                                             |                                                                                                               |                                                                                                        |
|                                  | `type: TRANSACTION_TYPE`                    |                                                                                             |                                                                                                               |                                                                                                        |
|                                  | `money: Money`                              |                                                                                             |                                                                                                               |                                                                                                        | 
|                                  | `balance: Money`                            |                                                                                             |                                                                                                               |                                                                                                        |
|                                  | `account: Account`                          |                                                                                             |                                                                                                               |                                                                                                        |
| `Account: abstract`              |                                             |                                                                                             |                                                                                                               |                                                                                                        |
|                                  | `iban: String`                              |                                                                                             |                                                                                                               |                                                                                                        |
|                                  | `accountNumber: String`                     |                                                                                             |                                                                                                               |                                                                                                        |
|                                  | `customer: Customer`                        |                                                                                             |                                                                                                               |                                                                                                        |
|                                  | `transactions: List<Transaction>`           |                                                                                             |                                                                                                               |                                                                                                        |
|                                  |                                             | `-generateAccountNumber(): void`                                                            | Create a new Account.                                                                                         | Generates a unique account number.                                                                     |
|                                  |                                             | `-composeIBAN(): void`                                                                      | Create a new Account.                                                                                         | Composes IBAN from Bank's locale and code, Branch's code and account number.                           |
|                                  |                                             | `getBankStatement(): String`                                                                | To get the transaction history in a format used for viewing on a  mobile phone.                               | Returns all transactions that have been made in this account.                                          |
|                                  |                                             | `printBankStatement(): void`                                                                | To view the transaction history for this account.                                                             | Prints all transactions that have been made in this account.                                           |
|                                  |                                             |                                                                                             | No transactions have been made.                                                                               | Show corresponding message.                                                                            |
|                                  |                                             | `deposit(amount: BigDecimal): void`                                                         | To deposit an amount of money in this account.                                                                | Calls createTransaction method with TRANSACTION_TYPE DEPOSIT                                           |
|                                  |                                             | `withdraw(amount: BigDecimal): void`                                                        | To withdraw an amount of money from this accounts.                                                            | Calls createTransaction method with TRANSACTION_TYPE WITHDRAWAL                                        |
|                                  |                                             |                                                                                             | Not enough money in the account.                                                                              | Show corresponding message.                                                                            |
|                                  |                                             | `createTransaction(amount: BigDecimal, type: TRANSACTION_TYPE): void`                       | Type is DEPOSIT                                                                                               | Creates a new Transaction of DEPOSIT type and adds it to the transactions list.                        |
|                                  |                                             |                                                                                             | Type is WITHDRAWAL, to withdraw an amount of money from this accounts.                                        | Creates a new Transaction of WITHDRAWAL type and adds it to the transactions list.                     |
|                                  |                                             | `getBalance() : Money`                                                                      | To get the balance of this account.                                                                           | Return the amount of money in this account.                                                            |
| `CurrentAccount extends Account` |                                             |                                                                                             |                                                                                                               |                                                                                                        |
|                                  | `overdraftRequests: List<OverdraftRequest>` |                                                                                             |                                                                                                               |                                                                                                        |
|                                  |                                             | `requestOverdraft(amount: BigDecimal): void`                                                | Request an overdraft from this account.                                                                       | Creates a new OverdraftRequest which is in PENDING state and awaits approval.                          |
|                                  |                                             | `overdraft(overdraftRequest: OverdraftRequest): void`                                       | Withdraw the amount requested.                                                                                | Calls createTransaction method with TRANSACTION_TYPE WITHDRAWAL                                        |
|                                  |                                             |                                                                                             | Overdraft hasn't been approved. Overdraft hasn't been processed.                                              | Show corresponding message.                                                                            |
| `SavingsAccount extends Account` |                                             |                                                                                             |                                                                                                               |                                                                                                        |
| `OverdraftRequest`               |                                             |                                                                                             |                                                                                                               |                                                                                                        |
|                                  | `account: Account`                          |                                                                                             |                                                                                                               |                                                                                                        |
|                                  | `state: OVERDRAFT_STATE`                    |                                                                                             |                                                                                                               |                                                                                                        |
|                                  | `amount: Money`                             |                                                                                             |                                                                                                               |                                                                                                        |
| `BankManager`                    |                                             |                                                                                             |                                                                                                               |                                                                                                        |
|                                  |                                             | `processOverdraftRequest(overdraftRequest: OverdraftRequest, state: OVERDRAFT_STATE): void` | Approve or deny an overdraft request.                                                                         | Set the state of the overdraft request to one of the available options.                                |
| `TwilioController`               |                                             |                                                                                             |                                                                                                               |                                                                                                        |
|                                  | `ACCOUNT_SID: String`                       |                                                                                             |                                                                                                               |                                                                                                        |
|                                  | `AUTH_TOKEN: String`                        |                                                                                             |                                                                                                               |                                                                                                        |
|                                  |                                             | `sendSms(context: String): void`                                                            | To sent the bank statement of an account to the user.                                                         | Sends the bank statement as an SMS to the user.                                                        |
| `BankController`                 |                                             |                                                                                             | A Controller class to manage a Bank.                                                                          |                                                                                                        |
|                                  | `bank: Bank`                                |                                                                                             |                                                                                                               |                                                                                                        |
|                                  |                                             | `createBankManager(): BankManager`                                                          |                                                                                                               |                                                                                                        |
|                                  |                                             | `createBranch(branchName: String, bankCode: String): Branch`                                |                                                                                                               |                                                                                                        |
|                                  |                                             | `createCustomer(branch: Branch, idCard: IDCard, tin: String): Customer`                     |                                                                                                               |                                                                                                        |
|                                  |                                             | `createCurrentAccount(customer: Customer): CurrentAccount`                                  |                                                                                                               |                                                                                                        |
|                                  |                                             | `createCurrentAccount(customer: Customer, amount: BigDecimal): CurrentAccount`              |                                                                                                               |                                                                                                        |
|                                  |                                             | `createSavingsAccount(customer: Customer): SavingsAccount`                                  |                                                                                                               |                                                                                                        |
|                                  |                                             | `createSavingsAccount(customer: Customer, amount: BigDecimal): SavingsAccount`              |                                                                                                               |                                                                                                        |
|                                  |                                             | `deposit(account: Account, amount: BigDecimal): void`                                       |                                                                                                               |                                                                                                        |
|                                  |                                             | `withdraw(account: Account, amount: BigDecimal): void`                                      |                                                                                                               |                                                                                                        |
|                                  |                                             | `createOverdraftRequest(account: Account, amount: BigDecimal): OverdraftRequest`            |                                                                                                               |                                                                                                        |
|                                  |                                             | `approveOverdraftRequest(request: OverdraftRequest): void`                                  |                                                                                                               |                                                                                                        |
|                                  |                                             | `denyOverdraftRequest(request: OverdraftRequest): void`                                     |                                                                                                               |                                                                                                        |
|                                  |                                             | `overdraft(account: Account, request: OverdraftRequest): void`                              |                                                                                                               |                                                                                                        |
|                                  |                                             | `printBankStatement(account: Account): void`                                                |                                                                                                               |                                                                                                        |
|                                  |                                             | `sendBankStatementToPhone(account: Account): void`                                          |                                                                                                               |                                                                                                        |

### Enumerations Used

```
TRANSACTION_TYPE: WITHDRAWAL, DEPOSIT.
ACCOUNT_TYPE: CURRENT, SAVINGS.
OVERDRAFT_STATE: PENDING, APPROVED, DENIED.
```

### Extra details

```
This app is to be used through the BankController class.
Restrictions
 - Branch can only be created through a Bank.
 - Customer can only be created through a Branch.
 - Account can only be created through a Customer.
 - Transaction can only be created through an Account.
 - Overdraft can only be created through an Account.
 - Some form of validation and business logic was implemented in the code.
 - IBAN (International Bank Account Number) structure: Country Code(2) + Check Digits(2) + BBAN(23).
 - BBAN (Basic Bank Account Number) structure: Bank Code(3) Branch Code(4) Account Number(16).
 - TIN (Tax Identification Number) structure: Country Code(2) + A nine digit number.
```

<!-- 
TODO:
 - Create UML Diagram with a correct tool.
 - Use a logger.
 - Add JavaDocs.
-->

## Class Diagram (outdated)

![A class diagram.](/assets/uml_diagram.png)